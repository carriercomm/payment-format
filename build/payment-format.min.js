/*! payment-format 2015-01-05 */
define([],function(){function a(a){var b;return null!=a.selectionStart&&a.selectionStart!==a.selectionEnd?!0:("undefined"!=typeof document&&null!==document&&null!=(b=document.selection)&&"function"==typeof b.createRange?b.createRange().text:void 0)?!0:!1}function b(b){var c,d,e,f;return c=b.target,e=String.fromCharCode(b.which),/^\d+$/.test(e)&&!a(c)?(f=(c.value+e).replace(/\D/g,""),d=h(f),d?f.length<=d.length[d.length.length-1]:f.length<=16):void 0}function c(a){var b,c,d,e;return(b=h(a))?(d=b.length[b.length.length-1],a=a.replace(/\D/g,""),a=a.slice(0,d),b.format.global?null!=(e=a.match(b.format))?e.join(" "):void 0:(c=b.format.exec(a),null!=c?(c.shift(),c=c.filter(function(a){return a}),c.join(" ")):void 0)):a}function d(a){var b,c,d,e,f,g,i;return d=String.fromCharCode(a.which),!/^\d+$/.test(d)||(b=a.target,i=b.value,c=h(i+d),e=(i.replace(/\D/g,"")+d).length,g=16,c&&(g=c.length[c.length.length-1]),e>=g||null!=b.selectionStart&&b.selectionStart!==i.length)?void 0:(f=c&&"amex"===c.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,f.test(i)?(a.preventDefault(),setTimeout(function(){return b.value=i+" "+d})):f.test(i+d)?(a.preventDefault(),setTimeout(function(){return b.value=i+d+" "})):void 0)}function e(a){var b,c;return b=a.target,c=b.value,8!==a.which||null!=b.selectionStart&&b.selectionStart!==c.length?void 0:/\d\s$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.value=c.replace(/\d\s$/,"")})):/\s\d?$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.value=c.replace(/\s\d?$/,"")})):void 0}function f(a){return setTimeout(function(){var b,d;b=a.target,d=b.value,d=c(d),b.value=d})}function g(a){var b,c,d,e,f;b=a.target,f=b.value,e=e(f)||"unknown",b.classList.contains(e)||(c=function(){var a,b,c;for(c=[],a=0,b=cards.length;b>a;a++)d=cards[a],c.push(d.type);return c}(),b.removeClass("unknown"),b.removeClass(c.join(" ")),b.addClass(e),b.toggleClass("identified","unknown"!==e))}function h(a){a=(a+"").replace(/\D/g,"");for(var b=0;b<cards.length;b++){var c=cards[b];if(c.pattern.test(a))return c}}function i(a){for(var b=0;b<cards.length;b++){var c=cards[b];if(c.type===a)return c}}function j(a){for(var b=!0,c=0,d=(a+"").split("").reverse(),e=0;e<d.length;e++)digit=d[e],digit=parseInt(digit,10),(b=!b)&&(digit*=2),digit>9&&(digit-=9),c+=digit;return c%10===0}function k(a){var a=(a+"").replace(/\s+|-/g,"");if(!/^\d+$/.test(a))return!1;var b=h(a);return b?b.length.indexOf(a.length)>=0&&(b.luhn===!1||j(a)):!1}function l(a,b){if(a=a.replace(/\s+/g,""),!/^\d+$/.test(a))return!1;var c=i(b);return null!=c?c.cvcLength.indexOf(a.length)>=0:a.length>=3&&a.length<=4}function m(a){var b;return a?(null!=(b=h(a))?b.type:void 0)||null:null}function n(a,b){var c,d,e;return"object"==typeof a&&"month"in a&&(e=a,a=e.month,b=e.year),a&&b?(a=(a+"").replace(/\s+/g,""),b=(b+"").replace(/\s+/g,""),/^\d+$/.test(a)&&/^\d+$/.test(b)&&a>=1&&12>=a?(2===b.length&&(b=70>b?"20"+b:"19"+b),4!==b.length?!1:(d=new Date(b,a),c=new Date,d.setMonth(d.getMonth()-1),d.setMonth(d.getMonth()+1,1),d>c)):!1):!1}function o(b){var c,d,e;return c=b.target,d=String.fromCharCode(b.which),/^\d+$/.test(d)&&!a(c)?(e=c.value+d,e=e.replace(/\D/g,""),e.length>6?!1:void 0):void 0}function p(a){return setTimeout(function(){var b,c;return b=a.target,c=b.value,c=u(c),b.value=c})}function q(a){var b,c,d;return c=String.fromCharCode(a.which),/^\d+$/.test(c)?(b=a.target,d=b.value+c,/^\d$/.test(d)&&"0"!==d&&"1"!==d?(a.preventDefault(),setTimeout(function(){return b.value="0"+d+" / "})):/^\d\d$/.test(d)?(a.preventDefault(),setTimeout(function(){return b.value=""+d+" / "})):void 0):void 0}function r(a){var b,c,d;return c=String.fromCharCode(a.which),/^\d+$/.test(c)?(b=a.target,d=b.value,/^\d\d$/.test(d)?b.value=""+d+" / ":void 0):void 0}function s(a){var b,c,d;return d=String.fromCharCode(a.which),"/"===d||" "===d?(b=a.target,c=b.value,/^\d$/.test(c)&&"0"!==c?b.value="0"+c+" / ":void 0):void 0}function t(a){var b,c;return b=a.target,c=b.value,8!==a.which||null!=b.selectionStart&&b.selectionStart!==c.length?void 0:/\s\/\s\d?$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.value=c.replace(/\s\/\s\d?$/,"")})):void 0}function u(a){var b,c,d,e;return(c=a.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(b=c[1]||"",d=c[2]||"",e=c[3]||"",(e.length>0||d.length>0&&!/\ \/?\ ?/.test(d))&&(d=" / "),1===b.length&&"0"!==b&&"1"!==b&&(b="0"+b,d=" / "),b+d+e):""}function v(a){var b;return a.metaKey||a.ctrlKey?!0:32===a.which?!1:0===a.which?!0:a.which<33?!0:(b=String.fromCharCode(a.which),!!/[\d\s]/.test(b))}function w(a){y(a),a.addEventListener("keypress",b),a.addEventListener("keypress",d),a.addEventListener("keydown",e),a.addEventListener("keyUp",g),a.addEventListener("paste",f),a.addEventListener("change",f),a.addEventListener("input",f),a.addEventListener("input",g)}function x(a){return y(a),a.addEventListener("keypress",o),a.addEventListener("keypress",q),a.addEventListener("keypress",s),a.addEventListener("keypress",r),a.addEventListener("keydown",t),a.addEventListener("change",p),a.addEventListener("input",p),this}function y(a){a.addEventListener("keypress",v)}var z=/(\d{1,4})/g;return z=/(\d{1,4})/g,cards=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:z,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:z,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:z,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:z,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:z,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[0-5]/,format:z,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:z,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:z,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^(62|88)/,format:z,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:z,length:[16],cvcLength:[3],luhn:!0}],{validateCardNumber:k,validateCardCVC:l,validateCardExpiry:n,cardType:m,makeCardFormatter:w,makeExpiryFormatter:x}});